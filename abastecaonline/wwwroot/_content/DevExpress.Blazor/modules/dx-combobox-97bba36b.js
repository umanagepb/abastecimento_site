import{a as e}from"./_tslib-158249d5.js";import{B as t}from"./browser-a3d50e79.js";import o from"./adaptivedropdowncomponents-0f3dbd54.js";import{D as n}from"./dx-dropdown-editor-base-fb2dac6c.js";import{ListBoxSelectedItemsChangedEvent as r}from"./dx-listbox-8f043178.js";import{e as i}from"./property-d3853089.js";import"./dropdowncomponents-8e7e3454.js";import"./popup-97b8c2f4.js";import"./rect-7fc5c2ef.js";import"./point-9c6ab88a.js";import"./rafaction-bba7928b.js";import"./transformhelper-ebad0156.js";import"./layouthelper-4b19d191.js";import"./positiontracker-dba18a16.js";import"./elementobserver-5f004683.js";import"./supportcaptureelement-35919fa4.js";import"./popuproot-d37b16a2.js";import"./branch-ea431ccc.js";import"./lit-element-b0a6fcba.js";import"./custom-element-bd7061f2.js";import"./data-qa-utils-8be7c726.js";import"./capturemanager-c7d5aef8.js";import"./simpleevent-84045703.js";import"./locker-c40478e6.js";import"./eventhelper-8570b930.js";import"./logicaltreehelper-15991dcb.js";import"./dx-ui-element-de378e9d.js";import"./lit-element-base-af247167.js";import"./nameof-factory-64d95f5b.js";import"./custom-events-helper-18f7786a.js";import"./thumb-b78dcc42.js";import"./query-44b9267f.js";import"./popupbasedialog-0778f080.js";import"./popupportal-447465dc.js";import"./events-interseptor-4336a3f0.js";import"./modalcomponents-25dbcc22.js";import"./dom-95153cd1.js";import"./dx-ui-handlers-bridge-4076ae57.js";import"./dx-dropdown-owner-899c537e.js";var d;!function(e){e.ContentOrEditorWidth="contentoreditorwidth",e.ContentWidth="contentwidth",e.EditorWidth="editorwidth"}(d||(d={}));class s extends n{constructor(){super(),this.boundOnKeyUpHandler=this.onKeyUp.bind(this),this.boundOnInputTextChangedHandler=this.onInputTextChanged.bind(this),this.boundOnDropDownSelectedItemsChangedHandler=this.onDropDownSelectedItemsChanged.bind(this),this.dropDownWidthMode=d.ContentOrEditorWidth,this.filteringEnabled=!1,this.dropDownWidthSourceResizeObserver=new ResizeObserver(this.onDropDownWidthSourceSizeChanged.bind(this))}get useMobileFocusBehaviour(){return t.MobileUI||super.useMobileFocusBehaviour}connectedCallback(){super.connectedCallback(),this.observeForDropDownWidthSourceElementSize(),this.addEventListener("keyup",this.boundOnKeyUpHandler),this.addEventListener("input",this.boundOnInputTextChangedHandler)}disconnectedCallback(){this.dropDownWidthSourceResizeObserver.disconnect(),this.removeEventListener("input",this.boundOnInputTextChangedHandler),this.removeEventListener("keyup",this.boundOnKeyUpHandler),super.disconnectedCallback()}updated(e){super.updated(e),e.has("dropDownWidthMode")&&this.prepareDropDownWidth()}onSlotChanged(e){super.onSlotChanged(e);const t=this.getDropDownWidthSourceElement();this.dropDownWidthSourceResizeObserver.observe(t)}invokeKeyDownServerCommand(e){var t,o;if(!this.requireSendKeyCommandToServer(e))return super.invokeKeyDownServerCommand(e);const n={key:e.key,altKey:e.altKey,ctrlKey:e.ctrlKey||e.metaKey,inputText:null===(t=this.inputElement)||void 0===t?void 0:t.value};return null===(o=this.uiHandlersBridge)||void 0===o||o.send("invokeKeyDownCommand",n),!0}processLostFocus(){var e,t;const o={text:null===(e=this.inputElement)||void 0===e?void 0:e.value};null===(t=this.uiHandlersBridge)||void 0===t||t.send("lostFocus",o)}onKeyUp(e){var t;if("ArrowUp"===e.key||"ArrowDown"===e.key){const o={key:e.key};null===(t=this.uiHandlersBridge)||void 0===t||t.send("invokeKeyUpCommand",o)}}onInputTextChanged(e){var t;if(!this.inputElement)return;if(!this.isDropDownOpen&&e.data&&e.data.length>0&&this.toggleDropDownVisibility(),!this.filteringEnabled)return;e.stopPropagation();null===(t=this.uiHandlersBridge)||void 0===t||t.send("invokeFilterChangedCommand",{text:this.inputElement.value})}onDropDownSelectedItemsChanged(e){e.stopPropagation();const t=e.target;null==t||t.scrollToFocusedItem(!1)}onDropDownWidthSourceSizeChanged(e,t){if(e.length<1||!this.dropDownElement)return;const o=e[0].contentRect.width+"px";this.dropDownElement.desiredWidth=this.dropDownWidthMode===d.EditorWidth?o:null,this.dropDownElement.minDesiredWidth=this.dropDownWidthMode===d.ContentOrEditorWidth?o:null}ensureDropDownElement(){var e;super.ensureDropDownElement(),null===(e=this.dropDownElement)||void 0===e||e.addEventListener(r.eventName,this.boundOnDropDownSelectedItemsChangedHandler)}disposeDropDownElement(){var e;null===(e=this.dropDownElement)||void 0===e||e.removeEventListener(r.eventName,this.boundOnDropDownSelectedItemsChangedHandler),super.disposeDropDownElement()}prepareDropDownWidth(){if(this.isInitialized)switch(this.dropDownWidthSourceResizeObserver.disconnect(),this.dropDownElement&&(this.dropDownElement.desiredWidth=null,this.dropDownElement.minDesiredWidth=null),this.dropDownWidthMode){case d.EditorWidth:case d.ContentOrEditorWidth:this.dropDownWidthSourceResizeObserver.observe(this.getDropDownWidthSourceElement())}}observeForDropDownWidthSourceElementSize(){this.dropDownWidthSourceResizeObserver.disconnect();const e=this.getDropDownWidthSourceElement();e&&this.dropDownWidthSourceResizeObserver.observe(e)}getDropDownWidthSourceElement(){return this.querySelector(".input-group")}requireSendKeyCommandToServer(e){switch(e.key){case"Enter":case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":return!0;case"Home":case"End":return e.ctrlKey||e.metaKey}return!1}}e([i({type:d,attribute:"dropdown-width-mode"})],s.prototype,"dropDownWidthMode",void 0),e([i({type:Boolean,attribute:"filtering-enabled"})],s.prototype,"filteringEnabled",void 0),customElements.define("dxbl-combobox",s);const p={loadModule:function(){},adaptiveDropdownComponents:o};export{s as DxComboBox,p as default};
