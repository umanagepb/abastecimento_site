import{a as t}from"./_tslib-158249d5.js";import{V as s,D as e,d as o,e as i,a,b as r,C as n}from"./popup-97b8c2f4.js";import{B as l}from"./popuproot-d37b16a2.js";import{P as h}from"./point-9c6ab88a.js";import{S as c,b as p}from"./rect-7fc5c2ef.js";import{D as d}from"./popupbasedialog-0778f080.js";import{L as m}from"./layouthelper-4b19d191.js";import{T as u}from"./transformhelper-ebad0156.js";import{D as f,d as g}from"./bootstrap-core-b1792266.js";import{e as b}from"./property-d3853089.js";import{n as y}from"./custom-element-bd7061f2.js";import{s as w,r as C,$ as S}from"./lit-element-b0a6fcba.js";import{i as v}from"./query-44b9267f.js";import{D as E}from"./popupportal-447465dc.js";import{d as P}from"./events-interseptor-4336a3f0.js";import"./rafaction-bba7928b.js";import"./positiontracker-dba18a16.js";import"./elementobserver-5f004683.js";import"./supportcaptureelement-35919fa4.js";import"./logicaltreehelper-15991dcb.js";import"./dx-ui-element-de378e9d.js";import"./lit-element-base-af247167.js";import"./data-qa-utils-8be7c726.js";import"./branch-ea431ccc.js";import"./capturemanager-c7d5aef8.js";import"./simpleevent-84045703.js";import"./locker-c40478e6.js";import"./eventhelper-8570b930.js";import"./nameof-factory-64d95f5b.js";import"./custom-events-helper-18f7786a.js";import"./dom-95153cd1.js";import"./browser-a3d50e79.js";import"./dom-utils-2919d18e.js";var j;var A;!function(t){t.top="top",t.right="right",t.bottom="bottom",t.left="left"}(A||(A={}));let T=j=class extends w{constructor(){super(...arguments),this.slotChangedHandler=this.handleSlotChanged.bind(this),this.arrow=null,this._alignment=A.bottom,this.position=s.zero,this.bootstrapVersion=f,this.serverClass=null,this.clientClass=null,this.cssClass=null}get alignment(){return this._alignment}set alignment(t){const s=this._alignment;this._alignment=t,this.clientClass=this.calcClientCssClass(t),this.requestUpdate("alignment",s)}calcClientCssClass(t){let s=t;return this.bootstrapVersion===g.v5&&(t===A.left&&(s="start"),t===A.right&&(s="end")),`bs-popover-${s}`}get arrowSize(){return this.arrow?j.calcSizeWithMargins(this.arrow,m.getRelativeElementRect(this.arrow).size):c.Empty}static calcSizeWithMargins(t,s){const e=window.getComputedStyle(t),o=parseFloat(e.marginLeft),i=parseFloat(e.marginRight),a=parseFloat(e.marginTop),r=parseFloat(e.marginBottom);return new c(s.width+o+i,s.height+a+r)}static get styles(){return C`
            :host {
                display: block;
            }
        }`}willUpdate(t){if(t.has("serverClass")||t.has("clientClass")){const t=[];this.clientClass&&this.clientClass.split(" ").forEach((s=>t.push(s))),this.serverClass&&this.serverClass.split(" ").forEach((s=>t.push(s))),this.cssClass=t.join(" ")}}updated(t){if(this.arrow&&t.has("position"))switch(this.alignment){case A.bottom:this.arrow.style.transform=u.translateWithoutFloor(Math.floor(this.position.x),.5);break;case A.top:this.arrow.style.transform=u.translateWithoutFloor(Math.floor(this.position.x),-.5);break;case A.left:this.arrow.style.transform=u.translateWithoutFloor(-.5,Math.floor(this.position.y));break;case A.right:this.arrow.style.transform=u.translateWithoutFloor(.5,Math.floor(this.position.y))}t.has("cssClass")&&(this.className=this.cssClass?this.cssClass:"")}render(){return S`
            <slot @slotchange="${this.slotChangedHandler}"></slot>
        `}handleSlotChanged(t){const s=t.target.assignedNodes();for(const t in s){const e=s[t];if(e instanceof HTMLElement){this.arrow=e;break}}}};t([b({reflect:!1})],T.prototype,"position",void 0),t([b({type:String,attribute:"bootstrap-version"})],T.prototype,"bootstrapVersion",void 0),t([b({type:String,attribute:"server-class"})],T.prototype,"serverClass",void 0),t([b({reflect:!1})],T.prototype,"clientClass",void 0),t([b({reflect:!1})],T.prototype,"cssClass",void 0),t([b({reflect:!1})],T.prototype,"alignment",null),T=j=t([y("dxbl-flyout-arrow")],T);var x;!function(t){t.Fade="fade",t.None="none"}(x||(x={}));let R=class extends d{constructor(){super(...arguments),this.arrowSlotChangeHandler=this.handleArrowSlotChange.bind(this),this._arrow=null,this._arrowAlignment=A.bottom,this.serverClass=null,this.clientClass=null,this.cssClass=null,this.animationType=x.Fade,this.animationEnabled=!1}get arrow(){return this._arrow}get arrowAlignment(){return this._arrowAlignment}set arrowAlignment(t){this._arrowAlignment=t,this.clientClass=this.calcClientCssClass(t)}calcClientCssClass(t){return`bs-popover-${t}`}calcAnimationTypeCssClass(){return"fade show"}willUpdate(t){if(t.has("serverClass")||t.has("clientClass")||t.has("animationEnabled")||t.has("animationType")){const t=[];if(this.serverClass&&this.serverClass.split(" ").forEach((s=>t.push(s))),this.clientClass&&this.clientClass.split(" ").forEach((s=>t.push(s))),this.animationEnabled&&this.animationType!==x.None){const s=t.indexOf(`dxbs-flyout-dialog-${this.animationType}`,0),e=this.calcAnimationTypeCssClass();s>-1?t.splice(s,1,e):t.push(e)}this.cssClass=t.join(" ")}}updated(t){t.has("cssClass")&&(this.className=this.cssClass?this.cssClass:"")}render(){return S`
            <slot></slot>
            <slot name="arrow" @slotchange="${this.arrowSlotChangeHandler}"></slot>
        `}handleArrowSlotChange(t){const s=t.target.assignedNodes();this._arrow=s[0]}};var B,L;t([b({type:String,attribute:"server-class"})],R.prototype,"serverClass",void 0),t([b({reflect:!1})],R.prototype,"clientClass",void 0),t([b({reflect:!1})],R.prototype,"cssClass",void 0),t([b({type:String,attribute:"animation-type"})],R.prototype,"animationType",void 0),t([b({type:Boolean,reflect:!1})],R.prototype,"animationEnabled",void 0),R=t([y("dxbl-flyout-dialog")],R),function(t){t[t.TopStart=1]="TopStart",t[t.Top=2]="Top",t[t.TopEnd=4]="TopEnd",t[t.RightStart=8]="RightStart",t[t.Right=16]="Right",t[t.RightEnd=32]="RightEnd",t[t.BottomStart=64]="BottomStart",t[t.Bottom=128]="Bottom",t[t.BottomEnd=256]="BottomEnd",t[t.LeftStart=512]="LeftStart",t[t.Left=1024]="Left",t[t.LeftEnd=2048]="LeftEnd"}(L||(L={}));class D extends n{constructor(t,s,e,o,i,a){super(s,e,o,i,a),this.flyoutPosition=t}}let M=B=class extends e{constructor(){super(),this.slotChangedHandler=this.handleSlotChange.bind(this),this.dialog=null,this.flyoutDistance=null,this.flyoutOffset=null,this.calcStartAlignment=()=>0,this.calcEndAlignment=(t,s)=>s-t,this.calcAlignment=(t,s)=>s/2-t/2,this.placement=o.Custom,this.fitToRestriction=!0,this.flyoutPosition=0}get actualDistance(){var t;return null!==(t=this.flyoutDistance)&&void 0!==t?t:2}get actualOffset(){var t;return null!==(t=this.flyoutOffset)&&void 0!==t?t:0}get branchType(){return l.DropDown}get child(){return this.root}processCustomPlacement(t,s){return this.calcCustomPlacements(t,s)}calcCustomPlacements(t,s){const e=[];if(!this.dialog||!this.dialog.arrow)return e;const o=this.getBounds(s),i=this.getBounds(t),a=this.dialog.arrow.arrowSize;return this.flyoutPosition&L.Bottom&&e.push(this.calcBottomPlacement(o,a,this.calcAlignment(i.width,o.width),L.Bottom)),this.flyoutPosition&L.BottomStart&&e.push(this.calcBottomPlacement(o,a,this.calcStartAlignment(),L.BottomStart)),this.flyoutPosition&L.BottomEnd&&e.push(this.calcBottomPlacement(o,a,this.calcEndAlignment(i.width,o.width),L.BottomEnd)),this.flyoutPosition&L.Top&&e.push(this.calcTopPlacement(i,a,this.calcAlignment(i.width,o.width),L.Top)),this.flyoutPosition&L.TopStart&&e.push(this.calcTopPlacement(i,a,this.calcStartAlignment(),L.TopStart)),this.flyoutPosition&L.TopEnd&&e.push(this.calcTopPlacement(i,a,this.calcEndAlignment(i.width,o.width),L.TopEnd)),this.flyoutPosition&L.Left&&e.push(this.calcLeftPlacement(i,a,this.calcAlignment(i.height,o.height),L.Left)),this.flyoutPosition&L.LeftStart&&e.push(this.calcLeftPlacement(i,a,this.calcStartAlignment(),L.LeftStart)),this.flyoutPosition&L.LeftEnd&&e.push(this.calcLeftPlacement(i,a,this.calcEndAlignment(i.height,o.height),L.LeftEnd)),this.flyoutPosition&L.Right&&e.push(this.calcRightPlacement(o,a,this.calcAlignment(i.height,o.height),L.Right)),this.flyoutPosition&L.RightStart&&e.push(this.calcRightPlacement(o,a,this.calcStartAlignment(),L.RightStart)),this.flyoutPosition&L.RightEnd&&e.push(this.calcRightPlacement(o,a,this.calcEndAlignment(i.height,o.height),L.RightEnd)),e}calcLeftPlacement(t,s,e,o){const n=new h(-t.width-s.width-this.actualDistance,e+this.actualOffset);return new D(o,n,i.Horizontal,!0,a.Near,r.bottom)}calcTopPlacement(t,s,e,o){const n=new h(e+this.actualOffset,-t.height-s.height-this.actualDistance);return new D(o,n,i.Vertical,!0,a.Near,r.top)}calcRightPlacement(t,s,e,o){const n=new h(t.width+s.width+this.actualDistance,e+this.actualOffset);return new D(o,n,i.Horizontal,!1,a.Far,r.bottom)}calcBottomPlacement(t,s,e,o){const n=new h(e+this.actualOffset,t.height+s.height+this.actualDistance);return new D(o,n,i.Vertical,!1,a.Near,r.bottom)}processBestTranslationResults(t,s,e,o,i,a,r,n,l){if(super.processBestTranslationResults(t,s,e,o,i,a,r,n,l),!this.dialog||!this.dialog.arrow)return;const h=this.calcArrowAlignment(a,r,n);this.dialog.arrowAlignment=h;const c=this.dialog.arrow;c.position=this.getArrowPosition(c,s,e,o,n,null==l?void 0:l.flyoutPosition),c.alignment=h}getArrowPosition(t,e,o,a,r,n){const l=r===i.Vertical,h=l?t.arrowSize.width:t.arrowSize.height,c=p.rectToRange(o,l),d=p.rectToRange(e,l),m=p.rectToRange(a,l);let u=d.start,f=d.end;this.fitToRestriction&&(d.start<=m.start?(u=m.start,f=u+d.size):d.end>=m.end&&(u=m.end-d.size,f=u+d.size));const[g,b]=[Math.max(u,c.start),Math.min(f,c.end)];let y;y=n&(L.RightStart|L.RightEnd|L.LeftStart|L.LeftEnd)?c.start:c.start+c.size/2;const w=this.alignWithinBoundaries(y-h/2,g,b),C=this.calculateArrowOffsetFromEdge(c,h,d);return l?new s(Math.min(Math.max(w-u,C),e.width-C-h),0):new s(0,Math.min(Math.max(w-f,C-e.height),-C-h))}calcArrowAlignment(t,s,e){return e===i.Vertical?s===r.bottom?A.bottom:A.top:t===a.Near?A.left:A.right}alignWithinBoundaries(t,s,e){return s>=e?(s+e)/2:Math.min(Math.max(t,s),e)}calculateArrowOffsetFromEdge(t,s,e){const o=Math.min(t.size-s,t.size/2-s/2);return Math.max(B.DefaultArrowOffsetFromEdge,Math.min(o,.2*e.size))}renderTemplate(){return S`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${l.Flyout}">
                <dxbl-flyout-root
                    id="root"
                    style="${this.rootCssStyle}">
                    ${this.renderDefaultSlot()}
                    ${this.renderBridgeSlot()}
                </dxbl-flyout-root>
            </dxbl-branch>
        `}renderDefaultSlot(){return S`<slot @slotchange="${this.slotChangedHandler}"></slot>`}handleSlotChange(t){const s=t.target.assignedNodes();this.dialog=s.find((t=>t instanceof R)),this.dialog&&(this.dialog.animationEnabled=this.animationEnabled),this.reposition()}updated(t){super.updated(t),this.dialog&&t.has("animationEnabled")&&(this.dialog.animationEnabled=this.animationEnabled)}};M.DefaultArrowOffsetFromEdge=8,t([v("#root",!0)],M.prototype,"root",void 0),t([b({type:Number,attribute:"flyout-position"})],M.prototype,"flyoutPosition",void 0),t([b({type:Number,attribute:"flyout-distance"})],M.prototype,"flyoutDistance",void 0),t([b({type:Number,attribute:"flyout-offset"})],M.prototype,"flyoutOffset",void 0),M=B=t([y("dxbl-flyout")],M);let z=class extends w{constructor(){super(...arguments),this.dropOpposite=!1,this.dropDirection=a.Near,this.dropAlignment=r.bottom}static get styles(){return C`
            :host {
                display: flex;
                flex: 1 1 auto;
                flex-direction: column;
                align-items: stretch;
                justify-items: stretch;
                min-height: 0;
            }
        }`}render(){return S`
            <slot></slot>
            <slot name="arrow"/>
        `}};t([b({type:Object,attribute:"drop-opposite"})],z.prototype,"dropOpposite",void 0),t([b({type:String,attribute:"drop-direction"})],z.prototype,"dropDirection",void 0),t([b({type:String,attribute:"drop-alignment"})],z.prototype,"dropAlignment",void 0),z=t([y("dxbl-flyout-root")],z);function F(t){return t}const O={getReference:F,registeredComponents:["dxbl-flyout","dxbl-flyout-dialog","dxbl-flyout-root",E,P,"dxbl-flyout-arrow"]};export{O as default,F as getReference};
