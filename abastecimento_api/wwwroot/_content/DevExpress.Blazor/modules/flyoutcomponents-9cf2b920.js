import{a as t}from"./_tslib-158249d5.js";import{V as s,D as e,d as o,C as r,e as i,a,b as l}from"./popup-77a1ae4b.js";import{B as n}from"./popuproot-4df55582.js";import{P as h,N as c}from"./point-9c6ab88a.js";import{D as p}from"./popupbasedialog-559fd684.js";import{S as d}from"./rect-2684652a.js";import{L as m}from"./layouthelper-c2462bd3.js";import{T as u}from"./transformhelper-3935ca6a.js";import{e as g,n as f}from"./property-ba1fa369.js";import{n as b,r as w,y as C}from"./lit-element-d284a100.js";import{i as y}from"./query-44b9267f.js";import{D as v,d as S}from"./events-interseptor-b260a35a.js";import"./rafaction-bba7928b.js";import"./positiontracker-9570b24e.js";import"./positiontrackerobserver-5fd93b2c.js";import"./supportcaptureelement-2f30b59b.js";import"./dx-ui-element-4d613bb9.js";import"./data-qa-utils-8be7c726.js";import"./branch-6684bbdd.js";import"./capturemanager-c228e074.js";import"./eventhelper-dec6cde0.js";var j;var x;!function(t){t.top="top",t.right="right",t.bottom="bottom",t.left="left"}(x||(x={}));let P=j=class extends b{constructor(){super(...arguments),this.slotChangedHandler=this.handleSlotChanged.bind(this),this.arrow=null,this._alignment=x.bottom,this.position=s.zero,this.serverClass=null,this.clientClass=null,this.cssClass=null}get alignment(){return this._alignment}set alignment(t){const s=this._alignment;this._alignment=t,this.clientClass=this.calcClientCssClass(t),this.requestUpdate("alignment",s)}calcClientCssClass(t){return`bs-popover-${t}`}get arrowSize(){return this.arrow?j.calcSizeWithMargins(this.arrow,m.getRelativeElementRect(this.arrow).size):d.Empty}static calcSizeWithMargins(t,s){const e=window.getComputedStyle(t),o=parseFloat(e.marginLeft),r=parseFloat(e.marginRight),i=parseFloat(e.marginTop),a=parseFloat(e.marginBottom);return new d(s.width+o+r,s.height+i+a)}static get styles(){return w`
            :host {
                display: block;
            }
            ::slotted(.arrow) {
                top: 0;
                left: 0;
            }
        }`}willUpdate(t){if(t.has("serverClass")||t.has("clientClass")){const t=[];this.clientClass&&this.clientClass.split(" ").forEach((s=>t.push(s))),this.serverClass&&this.serverClass.split(" ").forEach((s=>t.push(s))),this.cssClass=t.join(" ")}}updated(t){this.arrow&&t.has("position")&&(this.arrow.style.transform=u.translate(this.position.x,this.position.y)),t.has("cssClass")&&(this.className=this.cssClass?this.cssClass:"")}render(){return C`
            <slot @slotchange="${this.slotChangedHandler}"></slot>
        `}handleSlotChanged(t){const s=t.target.assignedNodes();for(const t in s){const e=s[t];if(e instanceof HTMLElement){this.arrow=e;break}}}};t([g({reflect:!1})],P.prototype,"position",void 0),t([g({type:String,attribute:"server-class"})],P.prototype,"serverClass",void 0),t([g({reflect:!1})],P.prototype,"clientClass",void 0),t([g({reflect:!1})],P.prototype,"cssClass",void 0),t([g({reflect:!1})],P.prototype,"alignment",null),P=j=t([f("dxbl-flyout-arrow")],P);let A=class extends p{constructor(){super(...arguments),this.arrowSlotChangeHandler=this.handleArrowSlotChange.bind(this),this._arrow=null,this._arrowAlignment=x.bottom,this.serverClass=null,this.clientClass=null,this.cssClass=null}get arrow(){return this._arrow}get arrowAlignment(){return this._arrowAlignment}set arrowAlignment(t){this._arrowAlignment=t,this.clientClass=this.calcClientCssClass(t)}calcClientCssClass(t){return`bs-popover-${t}`}willUpdate(t){if(t.has("serverClass")||t.has("clientClass")){const t=[];this.serverClass&&this.serverClass.split(" ").forEach((s=>t.push(s))),this.clientClass&&this.clientClass.split(" ").forEach((s=>t.push(s))),this.cssClass=t.join(" ")}}updated(t){t.has("cssClass")&&(this.className=this.cssClass?this.cssClass:"")}render(){return C`
            <slot></slot>
            <slot name="arrow" @slotchange="${this.arrowSlotChangeHandler}"></slot>
        `}handleArrowSlotChange(t){const s=t.target.assignedNodes();this._arrow=s[0]}};var B;t([g({type:String,attribute:"server-class"})],A.prototype,"serverClass",void 0),t([g({reflect:!1})],A.prototype,"clientClass",void 0),t([g({reflect:!1})],A.prototype,"cssClass",void 0),A=t([f("dxbl-flyout-dialog")],A),function(t){t.Auto="auto",t.LeftStart="leftstart",t.Left="left",t.LeftEnd="leftend",t.TopStart="topstart",t.Top="top",t.TopEnd="topend",t.RightStart="rightstart",t.Right="right",t.RightEnd="rightend",t.BottomStart="bottomstart",t.Bottom="bottom",t.BottomEnd="bottomend"}(B||(B={}));let R=class extends e{constructor(){super(),this.slotChangedHandler=this.handleSlotChange.bind(this),this.dialog=null,this.flyoutPlacement=B.Auto,this.placement=o.Custom}get branchType(){return n.DropDown}get child(){return this.root}processCustomPlacement(t,s){return this.calcCustomPlacements(t,s)}calcCustomPlacements(t,s){const e=[];switch(this.flyoutPlacement){case B.Bottom:e.push(this.calcBottomPlacement(t,s));break;case B.Top:e.push(this.calcTopPlacement(t,s));break;case B.Left:e.push(this.calcLeftPlacement(t,s));break;case B.Right:e.push(this.calcRightPlacement(t,s));break;case B.Auto:e.push(this.calcBottomPlacement(t,s)),e.push(this.calcTopPlacement(t,s)),e.push(this.calcLeftPlacement(t,s)),e.push(this.calcRightPlacement(t,s))}return e}calcBottomPlacement(t,s){const e=this.getBounds(s),o=this.getBounds(t);return new r(new h(e.width/2-o.width/2,e.height),i.Vertical,!1,a.Near,l.bottom)}calcTopPlacement(t,s){const e=this.getBounds(s),o=this.getBounds(t);return new r(new h(e.width/2-o.width/2,-o.height),i.Vertical,!1,a.Near,l.top)}calcLeftPlacement(t,s){const e=this.getBounds(s),o=this.getBounds(t);return new r(new h(-o.width,e.height/2-o.height/2),i.Horizontal,!1,a.Near,l.bottom)}calcRightPlacement(t,s){const e=this.getBounds(s),o=this.getBounds(t);return new r(new h(e.width,e.height/2-o.height/2),i.Horizontal,!1,a.Far,l.bottom)}renderTemplate(){return C`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${n.Flyout}">
                <dxbl-flyout-root
                    id="root"
                    style="${this.rootCssStyle}">
                    ${this.renderDefaultSlot()}
                    ${this.renderBridgeSlot()}
                </dxbl-flyout-root>
            </dxbl-branch>
        `}renderDefaultSlot(){return C`<slot @slotchange="${this.slotChangedHandler}"></slot>`}handleSlotChange(t){const s=t.target.assignedNodes();this.dialog=s.find((t=>t instanceof A)),this.reposition()}processBestTranslationResults(t,s,e,o,r,i,a){if(super.processBestTranslationResults(t,s,e,o,r,i,a),!this.dialog||!this.dialog.arrow)return;const l=this.calcArrowAlignment(r,i,a);this.dialog.arrowAlignment=l;const n=this.dialog.arrow,h=n.arrowSize,c=this.calcArrowPosition(h,t,s,e,r,i,a);n.position=this.validateArrowPosition(c,h,s,a),n.alignment=l}validateArrowPosition(t,e,o,r){return new s(c.toRange(t.x,r===i.Vertical?e.width:0,o.width-e.width),c.toRange(t.y,r===i.Horizontal?e.height:0,o.height-e.height))}calcArrowPosition(t,e,o,r,a,l,n){if(n===i.Horizontal){return new s(0,r.y+r.height/2-e.y-t.height/2)}if(n===i.Vertical){return new s(r.x+r.width/2-e.x-t.width/2,0)}return s.zero}calcArrowAlignment(t,s,e){return e===i.Vertical?s===l.bottom?x.bottom:x.top:t===a.Near?x.left:x.right}};t([y("#root",!0)],R.prototype,"root",void 0),t([g({type:String,attribute:"flyout-placement"})],R.prototype,"flyoutPlacement",void 0),R=t([f("dxbl-flyout")],R);let T=class extends b{constructor(){super(...arguments),this.dropOpposite=!1,this.dropDirection=a.Near,this.dropAlignment=l.bottom}static get styles(){return w`
            :host {
                display: flex;
                flex: 1 1 auto;
                flex-direction: column;
                align-items: stretch;
                justify-items: stretch;
                min-height: 0;
            }
        }`}render(){return C`
            <slot></slot>
            <slot name="arrow"/>
        `}};t([g({type:Object,attribute:"drop-opposite"})],T.prototype,"dropOpposite",void 0),t([g({type:String,attribute:"drop-direction"})],T.prototype,"dropDirection",void 0),t([g({type:String,attribute:"drop-alignment"})],T.prototype,"dropAlignment",void 0),T=t([f("dxbl-flyout-root")],T);function z(t){return t}const E={getReference:z,registeredComponents:["dxbl-flyout","dxbl-flyout-dialog","dxbl-flyout-root",v,S,"dxbl-flyout-arrow"]};export{E as default,z as getReference};
